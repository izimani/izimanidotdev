---
import { Picture } from "astro:assets";
import Assets from "../../util/assets";
import Figure from "./Figure.astro";
import type { CollectionEntry } from "astro:content";
import { getCurrentlyRenderedPost } from "#posts";

interface Props {
  src: string;
  alt: string;
  caption?: string;
}

const { src, alt, caption } = Astro.props;
const post = getCurrentlyRenderedPost() as CollectionEntry<"posts">;
---

<style>
  .image {
    width: 100%;
    height: auto;
    object-fit: cover;
  }
</style>
<Figure caption={caption || alt}>
  <Picture class="image" src={Assets.getPostImage(post, src)} alt={alt} />
</Figure>
